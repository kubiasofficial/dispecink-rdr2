<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <style>
        body { background-color: #1e1c1a; color: #d2c1ae; font-family: "Courier New", Courier, monospace; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .log-book { background-color: #2d2a27; border: 1px solid #b09060; padding: 40px; width: 750px; box-shadow: 0 0 30px rgba(0,0,0,0.7); text-align: center; }
        h1 { color: #b09060; letter-spacing: 4px; text-transform: uppercase; margin-bottom: 10px; }
        h2 { color: #b09060; font-size: 1rem; margin-bottom: 30px; letter-spacing: 2px; }
        
        /* Karty kol */
        .rounds-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px; }
        .round-card { 
            border: 1px solid #4d453d; padding: 15px; width: 120px; cursor: pointer; 
            text-transform: uppercase; transition: 0.2s; font-size: 0.8rem; background: #1a1816;
        }
        .round-card:hover { border-color: #b09060; color: #b09060; }
        .round-card.active { background-color: #b09060; color: #1a1816; font-weight: bold; }

        /* N치hled j칤zdn칤ho 콏치du */
        .timetable-preview { 
            background: #141210; border: 1px solid #4d453d; padding: 20px; 
            margin-bottom: 30px; text-align: left; max-height: 300px; overflow-y: auto;
        }
        .tt-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #222; font-size: 0.9rem; }
        .cargo-tag { color: #b09060; font-size: 0.7rem; font-weight: bold; }

        .footer-info { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #4d453d; padding-top: 20px; }
        .end-time { color: #b09060; font-weight: bold; font-size: 1.1rem; }

        .confirm-btn { 
            background: #b09060; color: #1a1816; border: none; padding: 15px 30px; 
            font-weight: bold; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; font-family: "Courier New";
        }
    </style>
</head>
<body>

<div class="log-book" id="shift-review">
    <h1>CONTINENTAL RAIL COMPANY</h1>
    <h2>[ PROS칈M OTEV콎I SI J칈ZDN칈 콎츼DY A ZKONTROLUJ SI SVOU SM캨NU ]</h2>

    <div class="rounds-container" id="rounds-list">
        </div>

    <div class="timetable-preview" id="tt-content">
        <p style="text-align:center; color:#666;">Vyberte kolo pro n치hled j칤zdn칤ho 콏치du</p>
    </div>

    <div class="footer-info">
        <div>KONEC SM캨NY: <span class="end-time" id="shift-end-display">--:--</span></div>
        <button class="confirm-btn" onclick="startShift()">SOUHLAS칈M</button>
    </div>
</div>

<script>
    // Konfigurace linek a telegram콢 dle zad치n칤
    const config = {
        lines: [
            { id: 1, name: "LINIE I.", gap: 5, stops: ["Saint Denis", "Emerald", "Valentine", "Flatneck", "Riggs", "Wallace", "Bacchus", "Annesburg", "Van Horn", "Saint Denis"], load: "Saint Denis", unload: "Wallace" },
            { id: 2, name: "LINIE II.", gap: 6, stops: ["Saint Denis", "Rhodes", "Flatneck", "Blackwater", "MacFarlane's Ranch", "Montana", "Flatneck", "Valentine", "Saint Denis"], load: "Saint Denis", unload: "MacFarlane's Ranch" },
            { id: 3, name: "LINIE III.", gap: 5, stops: ["Saint Denis", "Van Horn", "Annesburg", "Bacchus Station", "Wallace Station", "Riggs Station", "Flatneck Station", "Rhodes"], load: "Saint Denis", unload: "Wallace Station" },
            { id: 4, name: "LINIE IV.", gap: 7, stops: ["Saint Denis", "Rhodes", "Flatneck", "Riggs", "Blackwater", "Riggs", "Flatneck", "Saint Denis"], load: "Saint Denis", unload: "Benedict Point" }
        ],
        webhook: "https://discord.com/api/webhooks/1462379181290553378/7szxSP1bgAiR1diwDixyPPrXxklYWVGdLn3xZy8czqxGbqda9wtryXNV_zqJXL3PHGKO"
    };

    let generatedShift = [];
    let startTime = new Date(); // Simulujeme za캜치tek te캞

    function generateFullShift() {
        let currentTime = new Date(startTime);
        // Generujeme 4 kola (ka쬯치 linka jednou pro uk치zku)
        for (let i = 0; i < 4; i++) {
            let line = config.lines[i];
            let roundStops = [];
            
            line.stops.forEach((stop, idx) => {
                let isCargo = (stop === line.load || stop === line.unload);
                if (idx > 0) {
                    currentTime = new Date(currentTime.getTime() + (line.gap * 60000));
                    if (isCargo) currentTime = new Date(currentTime.getTime() + (3 * 60000));
                }
                roundStops.push({ 
                    name: stop, 
                    time: `${currentTime.getHours().toString().padStart(2, '0')}:${currentTime.getMinutes().toString().padStart(2, '0')}`,
                    cargo: stop === line.load ? "NAKL츼DKA" : (stop === line.unload ? "VYKL츼DKA" : null)
                });
            });
            
            generatedShift.push({ lineName: line.name, stops: roundStops });
            // Pauza v Saint Denis po kole (5 min)
            currentTime = new Date(currentTime.getTime() + (5 * 60000));
        }
        
        document.getElementById('shift-end-display').innerText = `${currentTime.getHours().toString().padStart(2, '0')}:${currentTime.getMinutes().toString().padStart(2, '0')}`;
        renderRoundButtons();
    }

    function renderRoundButtons() {
        let html = "";
        generatedShift.forEach((round, idx) => {
            html += `<div class="round-card" onclick="viewRound(${idx}, this)">KOLO ${idx + 1}</div>`;
        });
        document.getElementById('rounds-list').innerHTML = html;
    }

    function viewRound(idx, el) {
        document.querySelectorAll('.round-card').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        
        let round = generatedShift[idx];
        let html = `<h3>${round.lineName}</h3>`;
        round.stops.forEach(s => {
            html += `<div class="tt-row">
                <span>${s.name} ${s.cargo ? `<span class="cargo-tag">[${s.cargo}]</span>` : ''}</span>
                <span>${s.time}</span>
            </div>`;
        });
        document.getElementById('tt-content').innerHTML = html;
    }

    async function startShift() {
        const timeStr = `${new Date().getHours()}:${new Date().getMinutes().toString().padStart(2, '0')}`;
        
        // Odesl치n칤 na Discord
        try {
            await fetch(config.webhook, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ content: `游뚝 **Nov치 sm캩na zah치jena**\nStrojv콢dce potvrdil pl치n a vyj칤쬯칤 v **${timeStr}**.` })
            });
        } catch (e) { console.error("Discord Webhook selhal."); }

        alert("Sm캩na potvrzena! P콏ech치z칤m do aktivn칤ho protokolu j칤zdy.");
        // Zde se p콏epne na okno prvn칤ho j칤zdn칤ho 콏치du se zvuky
    }

    generateFullShift();
</script>
</body>
</html>
